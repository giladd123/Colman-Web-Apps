<!DOCTYPE html>
<html lang="en">
<%- include('partials/head', { extraCss: [ "/style/main_menu.css" , "/style/like_button.css" , "/style/navbar.css"
    , "/style/dropdown.css" , "/style/content.css" , "/style/watchlist.css" , "/style/genre.css"
    , "https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" ] }) %>

    <body>
        <%- include('partials/navbar', { activeNav: 'genres' }) %>

            <!-- Genre page header and controls -->
            <div class="container py-4" style="margin-top: 80px;">
                <div
                    class="d-flex flex-column flex-lg-row justify-content-between align-items-start align-items-lg-center mb-4 gap-3">
                    <h1 class="text-white">
                        <%= genre %> Movies & Shows
                    </h1>

                    <!-- Sorting and filtering controls -->
                    <div class="d-flex flex-column flex-sm-row gap-2 gap-sm-3 w-100 w-lg-auto">
                        <!-- Sort dropdown -->
                        <div class="dropdown flex-grow-1 flex-sm-grow-0">
                            <button class="btn btn-dark dropdown-toggle w-100" type="button" id="sortDropdown"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-sort-down me-2"></i>Sort by: <span id="currentSort">Popularity</span>
                            </button>
                            <ul class="dropdown-menu bg-dark" aria-labelledby="sortDropdown">
                                <li><a class="dropdown-item text-white" href="#"
                                        onclick="changeSorting('popularity', 'desc')">
                                        <i class="bi bi-star-fill me-2"></i>Popularity
                                        (High to Low)</a></li>
                                <li><a class="dropdown-item text-white" href="#"
                                        onclick="changeSorting('popularity', 'asc')">
                                        <i class="bi bi-star me-2"></i>Popularity
                                        (Low to High)</a></li>
                                <li><a class="dropdown-item text-white" href="#"
                                        onclick="changeSorting('imdbRating', 'desc')">
                                        <i class="bi bi-award-fill me-2"></i>Rating
                                        (High to Low)</a></li>
                                <li><a class="dropdown-item text-white" href="#"
                                        onclick="changeSorting('imdbRating', 'asc')">
                                        <i class="bi bi-award me-2"></i>Rating (Low
                                        to High)</a></li>
                                <li><a class="dropdown-item text-white" href="#"
                                        onclick="changeSorting('releaseYear', 'desc')">
                                        <i class="bi bi-calendar-fill me-2"></i>Newest
                                        First</a></li>
                                <li><a class="dropdown-item text-white" href="#"
                                        onclick="changeSorting('releaseYear', 'asc')">
                                        <i class="bi bi-calendar me-2"></i>Oldest
                                        First</a></li>
                            </ul>
                        </div>

                        <!-- Filter dropdown -->
                        <div class="dropdown flex-grow-1 flex-sm-grow-0">
                            <button class="btn btn-dark dropdown-toggle w-100" type="button" id="filterDropdown"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-funnel me-2"></i>Filter: <span id="currentFilter">All Content</span>
                            </button>
                            <ul class="dropdown-menu bg-dark" aria-labelledby="filterDropdown">
                                <li><a class="dropdown-item text-white" href="#" onclick="changeFilter('all')">
                                        <i class="bi bi-collection me-2"></i>All
                                        Content</a></li>
                                <li><a class="dropdown-item text-white" href="#" onclick="changeFilter('watched')">
                                        <i class="bi bi-check-circle me-2"></i>Already
                                        Watched</a></li>
                                <li><a class="dropdown-item text-white" href="#" onclick="changeFilter('unwatched')">
                                        <i class="bi bi-circle me-2"></i>Not
                                        Watched</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content container -->
            <div id="content" class="container py-4"></div>

            <!-- Loading indicator -->
            <div id="loading" class="text-center py-4" style="display: none;">
                <div class="spinner-border text-danger" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="text-white mt-2">Loading more content...</p>
            </div>

            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

            <!-- Include existing scripts -->
            <script src="/scripts/login_handler.js"></script>
            <script src="/scripts/utils.js"></script>
            <script src="/scripts/likes_manager.js"></script>
            <script src="/scripts/watchlist_manager.js"></script>
            <script src="/scripts/card_renderer.js"></script>
            <script src="/scripts/row_renderer.js"></script>
            <script src="/scripts/content_renderer.js"></script>
            <script src="/scripts/search.js"></script>
            <script src="/scripts/init.js"></script>
            <script src="/scripts/genre_page.js"></script>
            <script>
                // Initialize the genre page with the current genre
                initializeGenrePage('<%= genre %>');
            </script>
    </body>

</html>